<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-2"/>
    <title>Projekt IIS</title>
    <style type="text/css">
    	table { border-collapse: collapse; }
    	td, th { border: 1px solid black; padding: 0.3em 0.5em; text-align: left; }
    	dt { font-weight: bold; margin-top: 0.5em; }
    </style>
</head>
<body>

<!-- Zkontrolujte prosím nastavení kódování v hlavièce dokumentu
     podle pou¾itého editoru -->

<h1>Jídelna: objednávka a rozvoz jídel</h1> <!-- Nahradte názvem svého zadání -->

<dl>
	<dt>Autori</dt>
	<dd>Natália Holková <!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xholko02@stud.fit.vutbr.cz">xholko02@stud.fit.vutbr.cz</a> -
		databáza, HTML templates, Docker, hosting
	</dd>
	<dd>Samuel Krempaský<!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xkremp01@stud.fit.vutbr.cz">xkremp01@stud.fit.vutbr.cz</a> -
		backend
	</dd>
  <dd>Matej Novák<!-- Nahraïte skuteèným jménem a e-mailem autora a popisem èinnosti -->
	    <a href="mailto:xnovak2f@stud.fit.vutbr.cz">xnovak2f@stud.fit.vutbr.cz</a> -
		dizajn
	</dd>
	<dt>URL aplikace</dt>
	<dd><a href="https://canteen-docker-gnb42qlp2a-uc.a.run.app/">https://canteen-docker-gnb42qlp2a-uc.a.run.app/</a></dd>
</dl>

<h2>U¾ívatelia systému pre testovanie</h2>
<table>
<tr><th>Login</th><th>Heslo</th><th>Role</th></tr>
<tr><td>xmrkva</td><td>123456</td><td>Administrátor</td></tr>
<tr><td>xkovac</td><td>123456</td><td>Operátor</td></tr>
<tr><td>xbalaz</td><td>123456</td><td>Vodiè</td></tr>
<tr><td>xmolna</td><td>123456</td><td>Stravník</td></tr>
</table>

<h2>Implementácia</h2>
<p>Struèná dokumentace k implementaci, která popisuje, které èásti projektu (napø. PHP skripty) implementují jednotlivé pøípady pou¾ití.</p>
<p>
Projekt je mo¾né rozdeli» do niekoµkých èastí a to èi u¾ abstraktne, pomocou MVC, alebo podµa súborov. Django pou¾íva MVC, av¹ak Views sú v prípade Djanga sú Controllers a Controllers sú Views. Následne vyu¾ívame templates - html súbory ulo¾ené v prieèinku templates, v ktorých prezentujeme dáta.
Hlavnými èas»ami projektu sú súbory models.py, views.py, forms.py a urls.py, kde sa rie¹i url routing.
<p>
V models.py je implementované databázovú schému, v ktorej sme si zadefinovali triedy, ktoré sú podtriedami models.Model a následne sme si pomocou dátových polí z nadtriedy vytvorili jednotlivé atribúty.
Views.py je súbor, kde je spravená väè¹ina logiky IS. Funkcie v tomto súbore si mô¾eme rozdeli» na ¹tyri  podcelky 
tzv. ClassBasedView, ktoré nám poskytuje framework django. My vyu¾ívame CreateView, UpdateView a DeleteView, ktoré nám slú¾ia na náhµad, editovanie, vytváranie a vymazávanie in¹tancií entít/modelov. Týmito views bola vytvorená väè¹ina administrácie na strane personálu. Formuláre k týmto views sú v súbore forms.py. Validácia prebieha automaticky pomocou frameworku.
</p>
<p>
Be¾né views, ktoré nám zobrazujú napríklad menu, prevádzky atï. Boli implementované nami, keï¾e sme èasto potrebovali u¾ívateµovi prezentova» len potrebné dáta.
</p>

<p>Na manipuláciu s u¾ívateµmi, èi¾e registrácia, login, zmena hesla a odhlásenie pou¾ívame views dodané Djangom. Vyu¾ívame pritom tzv. User Model, ktorý sme si roz¹írili o vlastný model Person. Registráciu sme museli upravi», keï¾e ukladáme rovnako do modelu User, ako aj do modelu Person. Tento spôsob implementácie sme si zvolili z dôvodu, ¾e django User model nie je µahko modifikovateµný, a preto sme si ho vz»ahom 1:1 roz¹írili, aby sme mohli v iných èastiach implementácie jednoduch¹ie pracova» s u¾ívateµmi a ich dátami.
</p>

<p>Posledná skupina views slú¾i na mazanie a pridávanie polo¾iek do objednávok, menus, atd. Jedná sa napr. o views add_to_cart() a remove_from_cart(). V prípade neregistrovaných u¾ívateµov v nich priamo vyu¾ívame sessions. Tieto funkcie sú taktie¾ implementované aj pre registrovaných u¾ívateµov
</p>

</p>
<h3>Databáza</h3>

<img src="db_schema.png">

<h2>In¹talácia</h2>

<h3>In¹talácia pomocou Docker</h3>

Prerekvizity:
<ul>
	<li>Docker</li>
</ul>

Postup:
<ol>
	<li>S»ahnutie statický obrázkov - stiahnu» z <a href="https://drive.google.com/file/d/1uHsfpln8rxuFnZLN_9o6wJJKOpXe8hK4/view?usp=sharing">Google Drive</a> a prekopírova» obsah do app/static/</li>
	<li>Presun do zlo¾ky s Dockerfile - <i>cd app/</i></li>
	<li>Vytvorenie docker image (niekedy treba <i>sudo</i>) - <i>docker build -t canteen-docker .</i></li>
	<i>Spustenie kontajneru (niekedy treba <i>sudo</i>) - <i>docker run -it -p 8888:8888 canteen-docker</i></li>
	<li>Stránky bude dostupná na <a href="http://localhost:8888/">localhost:8888</a></li>
</ol>

<h3>In¹talácia bez Docker</h3>

Prerekvizity:
<ul>
    <li>Python 3.6+</li>
    <li>Django 2.2+</li>
</ul>

Postup:
<ol>
	<li>S»ahnutie statický obrázkov - stiahnu» z <a href="https://drive.google.com/file/d/1uHsfpln8rxuFnZLN_9o6wJJKOpXe8hK4/view?usp=sharing">Google Drive</a> a prekopírova» obsah do app/static/</li>
	<li>Presun do zlo¾ky s <i>manage.py</i> - cd app/</li>
	<li>Nastavanie databázy a naplnenie vstupnými údajmi - python3 manage.py migrate</li>
	<li>Zozbieranie statický súborov - python3 manage.py collectstatic --noinput</li>
	<li>Sputenie serveru - python3 manage.py runserver
	<li>Stránka je teraz dostupná na <a href="http://127.0.0.1:8000/">127.0.0.1:8000</a></li>
</ol>

</body>
</html>
